<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fundraising Assessment Pro</title>
    <meta name="description" content="Transform your fundraising approach with donor-centered strategies. Created by Mark Dobosz.">
    <meta name="author" content="Mark Dobosz">
    <meta property="og:title" content="Fundraising Assessment Pro - Transform Your Donor Relationships">
    <meta property="og:description" content="Stop leading with your organization's needs. Start with curiosity about your donors.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://images.unsplash.com/photo-1559526324-4b87b5e36e44?w=1200&h=630&fit=crop">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Fundraising Assessment Pro">
    <meta name="twitter:description" content="Transform your fundraising approach with donor-centered strategies.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8fafc;
        }

        .app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
        }

        .header-info {
            color: #64748b;
            font-size: 0.875rem;
        }

        .header-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .main-content {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .hero {
            text-align: center;
            margin-bottom: 4rem;
            padding: 3rem 2rem;
            background: linear-gradient(135deg, #dbeafe 0%, #e0e7ff 100%);
            border-radius: 1rem;
        }

        .hero h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.25rem;
            color: #475569;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .feature-card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.75rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: white;
            color: #374151;
            border: 1px solid #d1d5db;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }

        .btn-secondary:disabled {
            background: #f3f4f6;
            color: #9ca3af;
            cursor: not-allowed;
        }

        .btn-admin {
            background: #6b7280;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-admin:hover {
            background: #4b5563;
        }

        .btn-share {
            background: #10b981;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-share:hover {
            background: #059669;
        }

        .btn-resources {
            background: #8b5cf6;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-resources:hover {
            background: #7c3aed;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-card h3 {
            font-size: 0.875rem;
            font-weight: 500;
            color: #64748b;
            margin-bottom: 0.5rem;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
        }

        .category-breakdown {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            margin-bottom: 2rem;
        }

        .category-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border-bottom: 1px solid #f1f5f9;
        }

        .category-item:last-child {
            border-bottom: none;
        }

        .category-name {
            font-weight: 500;
            color: #1e293b;
        }

        .category-stats {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .category-percentage {
            font-weight: 600;
            color: #3b82f6;
        }

        .category-count {
            font-size: 0.875rem;
            color: #64748b;
        }

        .category-bar {
            width: 100px;
            height: 8px;
            background: #f1f5f9;
            border-radius: 4px;
            overflow: hidden;
        }

        .category-bar-fill {
            height: 100%;
            background: #3b82f6;
            transition: width 0.3s ease;
        }

        .share-stats {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            margin-bottom: 2rem;
        }

        .share-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
        }

        .share-item:last-child {
            border-bottom: none;
        }

        .recent-completions {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .completions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .completion-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            background: #f8fafc;
        }

        .completion-score {
            font-size: 1.5rem;
            font-weight: 700;
            color: #3b82f6;
            min-width: 4rem;
        }

        .completion-category {
            font-weight: 500;
            color: #1e293b;
        }

        .completion-date {
            font-size: 0.875rem;
            color: #64748b;
        }

        .footer {
            background: white;
            border-top: 1px solid #e2e8f0;
            padding: 1.5rem 2rem;
            text-align: center;
            color: #64748b;
            font-size: 0.875rem;
            margin-top: auto;
        }

        .hidden {
            display: none;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 0.5rem;
            background: #e2e8f0;
            border-radius: 0.25rem;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #3b82f6;
            transition: width 0.3s ease;
        }

        .question-card {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }

        .question-card h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1.5rem;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .option {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .option:hover {
            background: #f8fafc;
            border-color: #3b82f6;
        }

        .option.selected {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .option input[type="radio"] {
            margin-top: 0.125rem;
        }

        .option span {
            flex: 1;
            font-weight: 500;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }

        .results-card {
            background: white;
            padding: 3rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }

        .score-circle {
            width: 8rem;
            height: 8rem;
            border-radius: 50%;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            position: relative;
        }

        .score-number {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
        }

        .results-card h2 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .text-green-600 { color: #059669; }
        .text-blue-600 { color: #2563eb; }
        .text-yellow-600 { color: #d97706; }
        .text-red-600 { color: #dc2626; }

        .recommendations {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .recommendation-card {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .recommendation-card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.75rem;
        }

        .recommendation-card ul {
            margin-top: 1rem;
            padding-left: 1.25rem;
        }

        .recommendation-card li {
            margin-bottom: 0.5rem;
            color: #64748b;
        }

        .actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .resource-section {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            margin-bottom: 2rem;
        }

        .resource-section h2 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .resource-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.75rem;
            margin-top: 1.5rem;
        }

        .resource-section h3:first-of-type {
            margin-top: 0;
        }

        /* Enhanced Share Modal Styles */
        .share-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .share-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .share-options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .share-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .share-option:hover {
            background: #f8fafc;
            border-color: #3b82f6;
            transform: translateY(-2px);
        }

        .share-option-icon {
            font-size: 1.5rem;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f1f5f9;
        }

        .share-option-name {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
        }

        .share-preview {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
        }

        .share-preview h4 {
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .share-preview-content {
            font-size: 0.875rem;
            color: #64748b;
            line-height: 1.4;
            white-space: pre-line;
        }

        @media (max-width: 768px) {
            .header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }
            
            .main-content {
                padding: 1rem;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .features {
                grid-template-columns: 1fr;
            }

            .header-buttons {
                justify-content: center;
            }

            .analytics-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .navigation {
                flex-direction: column;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .recommendations {
                grid-template-columns: 1fr;
            }

            .category-stats {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-end;
            }

            .category-bar {
                width: 80px;
            }

            .share-options-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .share-modal-content {
                padding: 1.5rem;
                margin: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Home Page -->
        <div id="home-page" class="page active">
            <header class="header">
                <h1>Fundraising Assessment Pro</h1>
                <div class="header-buttons">
                    <button onclick="openShareModal('home')" class="btn-share">📤 Share</button>
                    <button onclick="showPage('resources-page')" class="btn-resources">📚 Resources</button>
                    <button onclick="adminLogin()" class="btn-admin">🔐 Admin</button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="hero">
                    <h2>Stop Leading with Your Organization's Needs</h2>
                    <p>Transform your fundraising approach by starting with curiosity about your donors. Learn to connect authentically and build lasting relationships that benefit both your cause and your supporters.</p>
                    <button onclick="startAssessment()" class="btn-primary">Take Assessment</button>
                </div>
                
                <div class="features">
                    <div class="feature-card">
                        <h3>🎯 Donor-Centered Approach</h3>
                        <p>Learn to connect with donors through genuine curiosity about their interests and passions.</p>
                    </div>
                    <div class="feature-card">
                        <h3>🤝 Relationship Building</h3>
                        <p>Discover how to build meaningful relationships that go beyond transactional interactions.</p>
                    </div>
                    <div class="feature-card">
                        <h3>📊 Strategic Assessment</h3>
                        <p>Evaluate your current fundraising approach and identify areas for improvement.</p>
                    </div>
                    <div class="feature-card">
                        <h3>📈 Proven Results</h3>
                        <p>Apply evidence-based strategies that successful fundraisers use to engage donors.</p>
                    </div>
                </div>

                <div style="text-align: center; background: #f1f5f9; padding: 2rem; border-radius: 1rem; margin-top: 2rem;">
                    <blockquote style="font-size: 1.5rem; font-style: italic; color: #1e293b; margin-bottom: 1rem;">
                        "What if you started with curiosity about the person you're talking to instead?"
                    </blockquote>
                    <p style="color: #64748b; margin-bottom: 1.5rem;">
                        By the time you talk about what your organization does, people are already thinking about 
                        how they might want to be involved—because the conversation started with their interests, not your needs.
                    </p>
                    <button onclick="startAssessment()" class="btn-primary">Start Your Assessment</button>
                </div>
            </main>
            
            <footer class="footer">
                <p>© 2025 Mark Dobosz. All rights reserved.</p>
            </footer>
        </div>

        <!-- Assessment Page -->
        <div id="assessment-page" class="page">
            <header class="header">
                <h1>Fundraising Assessment</h1>
                <div class="header-info">
                    <span id="question-counter">Question 1 of 8</span>
                </div>
            </header>
            
            <main class="main-content">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 12.5%"></div>
                </div>
                
                <div id="question-card" class="question-card">
                    <!-- Question content will be inserted here -->
                </div>
                
                <div class="navigation">
                    <button id="prev-btn" onclick="previousQuestion()" class="btn-secondary" disabled>← Previous</button>
                    <button id="next-btn" onclick="nextQuestion()" class="btn-primary" disabled>Next →</button>
                </div>
            </main>
        </div>

        <!-- Results Page -->
        <div id="results-page" class="page">
            <header class="header">
                <h1>Your Assessment Results</h1>
                <div class="header-buttons">
                    <button onclick="openShareModal('results')" class="btn-share">📤 Share Results</button>
                    <button onclick="showPage('resources-page')" class="btn-resources">📚 Resources</button>
                    <button onclick="showPage('home-page')" class="btn-secondary">← Home</button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="results-card">
                    <div class="score-circle">
                        <div id="final-score" class="score-number">0%</div>
                    </div>
                    <h2 id="score-category" class="text-blue-600">Assessment Complete</h2>
                    <p id="score-description">Based on your responses, here's how you can improve your fundraising approach:</p>
                </div>
                
                <div class="recommendations">
                    <div class="recommendation-card">
                        <h3>🎯 Start with Curiosity</h3>
                        <p>Begin every donor conversation by asking about their interests and what matters to them personally.</p>
                        <ul>
                            <li>Ask: "What first got you interested in this issue?"</li>
                            <li>Listen for personal stories and experiences</li>
                            <li>Show genuine curiosity about their perspective</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-card">
                        <h3>👂 Listen More, Talk Less</h3>
                        <p>Aim for 70% listening and 30% talking in your donor conversations.</p>
                        <ul>
                            <li>Ask follow-up questions to understand deeper</li>
                            <li>Resist the urge to immediately connect to your organization</li>
                            <li>Let donors share their full story before responding</li>
                        </ul>
                    </div>

                    <div class="recommendation-card">
                        <h3>🤝 Connect Authentically</h3>
                        <p>Make connections between donor interests and your work naturally, not forcefully.</p>
                        <ul>
                            <li>Wait for organic opportunities to share your work</li>
                            <li>Focus on shared values rather than organizational needs</li>
                            <li>Let the connection emerge from their interests</li>
                        </ul>
                    </div>
                </div>
                
                <div class="actions">
                    <button onclick="startAssessment()" class="btn-primary">🔄 Retake Assessment</button>
                    <button onclick="showPage('resources-page')" class="btn-resources">📚 View Resources</button>
                    <button onclick="openShareModal('results')" class="btn-secondary">📤 Share Results</button>
                </div>
            </main>
        </div>

        <!-- Resources Page -->
        <div id="resources-page" class="page">
            <header class="header">
                <h1>📚 Fundraising Resources</h1>
                <div class="header-buttons">
                    <button onclick="openShareModal('resources')" class="btn-share">📤 Share</button>
                    <button onclick="showPage('home-page')" class="btn-secondary">← Home</button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="resource-section">
                    <h2>🎯 Donor-Centered Fundraising Best Practices</h2>
                    
                    <h3>🗣️ Conversation Starters</h3>
                    <p>Instead of leading with your organization's needs, try these donor-centered openers:</p>
                    <ul>
                        <li><strong>"What first got you interested in [cause area]?"</strong> - Opens the door to their personal story</li>
                        <li><strong>"What would you most like to see change in this area?"</strong> - Reveals their vision and priorities</li>
                        <li><strong>"Tell me about a time when you felt really connected to this cause."</strong> - Invites emotional engagement</li>
                        <li><strong>"What questions do you have about the work we're doing?"</strong> - Shows you value their curiosity</li>
                    </ul>

                    <h3>👂 Active Listening Techniques</h3>
                    <p>Transform your conversations by becoming a better listener:</p>
                    <ul>
                        <li><strong>The 70/30 Rule:</strong> Aim for 70% listening, 30% talking in donor meetings</li>
                        <li><strong>Ask Follow-up Questions:</strong> "Tell me more about that..." or "What was that experience like?"</li>
                        <li><strong>Reflect Back:</strong> "It sounds like you're saying..." to show you're truly hearing them</li>
                        <li><strong>Pause Before Responding:</strong> Give them space to share more before jumping in</li>
                        <li><strong>Take Notes:</strong> Shows respect and helps you remember their interests for future conversations</li>
                    </ul>

                    <h3>🤝 Building Authentic Relationships</h3>
                    <p>Move beyond transactional interactions to meaningful partnerships:</p>
                    <ul>
                        <li><strong>Find Common Ground:</strong> Look for shared values and experiences, not just shared interests in your cause</li>
                        <li><strong>Be Genuinely Curious:</strong> Ask questions because you want to know, not because you're fishing for information</li>
                        <li><strong>Share Appropriately:</strong> When they ask about you, share authentically but keep the focus on them</li>
                        <li><strong>Follow Their Lead:</strong> Let them guide the conversation to topics they're passionate about</li>
                        <li><strong>Remember Personal Details:</strong> Follow up on things they've shared in previous conversations</li>
                    </ul>

                    <h3>⏰ Timing Your Ask</h3>
                    <p>Know when and how to transition from relationship-building to partnership discussions:</p>
                    <ul>
                        <li><strong>Wait for Natural Openings:</strong> "How can I get involved?" or "What do you need most?"</li>
                        <li><strong>Connect to Their Interests:</strong> Link giving opportunities to what they've told you matters to them</li>
                        <li><strong>Start with Engagement:</strong> Invite them to see your work before asking for financial support</li>
                        <li><strong>Make it About Impact:</strong> Frame requests around the change they want to see, not your budget needs</li>
                    </ul>

                    <h3>🚫 Common Mistakes to Avoid</h3>
                    <p>Pitfalls that can derail donor-centered conversations:</p>
                    <ul>
                        <li><strong>The Immediate Pivot:</strong> Don't immediately connect everything they say to your organization</li>
                        <li><strong>The Monologue:</strong> Avoid long presentations about your work without checking for engagement</li>
                        <li><strong>The Assumption:</strong> Don't assume you know what they care about based on their demographics</li>
                        <li><strong>The Pushy Follow-up:</strong> Respect their timeline and communication preferences</li>
                        <li><strong>The One-Size-Fits-All:</strong> Tailor your approach to each individual donor's interests and style</li>
                    </ul>

                    <h3>📈 Measuring Success</h3>
                    <p>How to know if your donor-centered approach is working:</p>
                    <ul>
                        <li><strong>Longer Conversations:</strong> Donors want to keep talking and sharing</li>
                        <li><strong>More Questions:</strong> They ask about your work because they're genuinely interested</li>
                        <li><strong>Repeat Engagement:</strong> They accept invitations to events, tours, or follow-up meetings</li>
                        <li><strong>Referrals:</strong> They introduce you to others who share their interests</li>
                        <li><strong>Deeper Giving:</strong> They increase their support over time as the relationship deepens</li>
                    </ul>
                </div>

                <div class="actions">
                    <button onclick="startAssessment()" class="btn-primary">📝 Take Assessment</button>
                    <button onclick="openShareModal('resources')" class="btn-secondary">📤 Share Resources</button>
                </div>
            </main>
        </div>

        <!-- Analytics Page -->
        <div id="analytics-page" class="page">
            <header class="header">
                <h1>📊 Analytics Dashboard</h1>
                <div class="header-buttons">
                    <button onclick="refreshAnalytics()" class="btn-secondary">🔄 Refresh</button>
                    <button onclick="showPage('home-page')" class="btn-secondary">← Home</button>
                    <button onclick="logoutAdmin()" class="btn-admin">🚪 Logout</button>
                </div>
            </header>
            
            <main class="main-content">
                <div class="analytics-grid">
                    <div class="stat-card">
                        <h3>Total Completions</h3>
                        <div id="total-completions" class="stat-number">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Average Score</h3>
                        <div id="average-score" class="stat-number">0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>This Month</h3>
                        <div id="month-completions" class="stat-number">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Shares</h3>
                        <div id="total-shares" class="stat-number">0</div>
                    </div>
                </div>

                <!-- Category Breakdown -->
                <div class="category-breakdown">
                    <h3>📈 Category Breakdown</h3>
                    <div id="category-breakdown-list">
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No data yet. Complete assessments to see category distribution.
                        </p>
                    </div>
                </div>

                <!-- Share Statistics -->
                <div class="share-stats">
                    <h3>📤 Share Statistics</h3>
                    <div id="share-stats-list">
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No shares yet. Share events will be tracked here.
                        </p>
                    </div>
                </div>
                
                <div class="recent-completions">
                    <h3>📈 Recent Completions</h3>
                    <div id="completions-list" class="completions-list">
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No completions yet. Share the assessment to start tracking results!
                        </p>
                    </div>
                </div>
            </main>
        </div>

        <!-- Enhanced Share Modal -->
        <div id="share-modal" class="share-modal hidden">
            <div class="share-modal-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                    <h2 id="share-modal-title">📤 Share Assessment</h2>
                    <button onclick="closeShareModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #64748b; padding: 0.5rem;">×</button>
                </div>
                
                <div class="share-options-grid">
                    <div class="share-option" onclick="shareViaEmail()">
                        <div class="share-option-icon">📧</div>
                        <div class="share-option-name">Email</div>
                    </div>
                    
                    <div class="share-option" onclick="shareViaLinkedIn()">
                        <div class="share-option-icon">💼</div>
                        <div class="share-option-name">LinkedIn</div>
                    </div>
                    
                    <div class="share-option" onclick="shareViaTwitter()">
                        <div class="share-option-icon">🐦</div>
                        <div class="share-option-name">Twitter</div>
                    </div>
                    
                    <div class="share-option" onclick="shareViaFacebook()">
                        <div class="share-option-icon">📘</div>
                        <div class="share-option-name">Facebook</div>
                    </div>
                    
                    <div class="share-option" onclick="shareViaWhatsApp()">
                        <div class="share-option-icon">💬</div>
                        <div class="share-option-name">WhatsApp</div>
                    </div>
                    
                    <div class="share-option" onclick="shareViaSMS()">
                        <div class="share-option-icon">📱</div>
                        <div class="share-option-name">SMS</div>
                    </div>
                    
                    <div class="share-option" onclick="copyShareLink()">
                        <div class="share-option-icon">🔗</div>
                        <div class="share-option-name">Copy Link</div>
                    </div>
                    
                    <div class="share-option" onclick="shareNative()">
                        <div class="share-option-icon">📤</div>
                        <div class="share-option-name">More</div>
                    </div>
                </div>
                
                <div class="share-preview">
                    <h4>Preview:</h4>
                    <div id="share-preview-content" class="share-preview-content">
                        Loading preview...
                    </div>
                </div>
                
                <div style="margin-top: 1.5rem; padding: 1rem; background: #f8fafc; border-radius: 0.5rem;">
                    <div style="font-size: 0.875rem; color: #64748b; margin-bottom: 0.5rem;">Share URL:</div>
                    <div id="share-url-display" style="font-size: 0.875rem; word-break: break-all; background: white; padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #e2e8f0;">
                        Loading...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // COMPLETE 8 ASSESSMENT QUESTIONS
        const questions = [
            {
                id: 1,
                question: "When you first meet a potential donor, what do you typically start with?",
                description: "Think about your usual opening conversation in a first meeting.",
                options: [
                    { value: 'organization', text: "Tell them about your organization and its needs", description: "Start with your mission, programs, and funding requirements", score: 1 },
                    { value: 'ask_interests', text: "Ask about their interests and what matters to them", description: "Show curiosity about their passions and values first", score: 5 },
                    { value: 'mixed', text: "Brief organization intro, then ask about their interests", description: "Combine both approaches in the conversation", score: 3 },
                    { value: 'unsure', text: "I'm not sure - it varies depending on the situation", description: "No consistent approach to opening conversations", score: 2 }
                ]
            },
            {
                id: 2,
                question: "How do you typically respond when someone shares their personal experiences or interests?",
                description: "Consider your natural reaction when donors open up about what they care about.",
                options: [
                    { value: 'connect_org', text: "Immediately connect it to how your organization addresses that issue", description: "Quick to make the link to your programs and services", score: 2 },
                    { value: 'ask_more', text: "Ask follow-up questions to understand their perspective better", description: "Show genuine curiosity and let them share more", score: 5 },
                    { value: 'acknowledge_pivot', text: "Acknowledge their interest, then pivot to your organization", description: "Brief recognition before steering to your agenda", score: 3 },
                    { value: 'listen_wait', text: "Listen carefully and wait for natural opportunities to connect", description: "Patient approach, letting connections emerge organically", score: 4 }
                ]
            },
            {
                id: 3,
                question: "What questions do you find most effective in donor conversations?",
                description: "Think about the questions that generate the most meaningful responses.",
                options: [
                    { value: 'giving_capacity', text: "Questions about their giving capacity and preferences", description: "Focus on donation amounts and giving history", score: 2 },
                    { value: 'personal_connection', text: "Questions about their personal connection to the cause", description: "What first got you interested in this issue?", score: 5 },
                    { value: 'org_programs', text: "Questions about which of your programs interest them most", description: "Present options and ask for their preferences", score: 3 },
                    { value: 'impact_vision', text: "Questions about what impact they'd most like to see", description: "What would make the biggest difference in your view?", score: 4 }
                ]
            },
            {
                id: 4,
                question: "How do you handle it when a donor seems hesitant or unengaged?",
                description: "Your approach when conversations aren't flowing naturally.",
                options: [
                    { value: 'push_harder', text: "Present more compelling information about your organization", description: "Share more statistics, stories, and urgent needs", score: 1 },
                    { value: 'step_back', text: "Step back and ask what's really important to them", description: "Shift focus entirely to their interests and concerns", score: 5 },
                    { value: 'different_angle', text: "Try a different angle or program that might interest them", description: "Present alternative ways they could get involved", score: 3 },
                    { value: 'end_gracefully', text: "Acknowledge it might not be the right fit and end gracefully", description: "Respect their position and maintain the relationship", score: 4 }
                ]
            },
            {
                id: 5,
                question: "What do you believe is the most important factor in successful fundraising?",
                description: "Your core philosophy about what makes fundraising work.",
                options: [
                    { value: 'compelling_case', text: "Having a compelling case for support", description: "Strong organizational story and clear needs", score: 2 },
                    { value: 'genuine_relationships', text: "Building genuine relationships based on shared values", description: "Authentic connections that go beyond transactions", score: 5 },
                    { value: 'right_timing', text: "Finding the right timing and approach for each donor", description: "Strategic timing and personalized cultivation", score: 4 },
                    { value: 'clear_impact', text: "Demonstrating clear, measurable impact", description: "Concrete results and accountability", score: 3 }
                ]
            },
            {
                id: 6,
                question: "How often do you find yourself talking versus listening in donor meetings?",
                description: "Be honest about the typical balance in your conversations.",
                options: [
                    { value: 'mostly_talking', text: "I do most of the talking - sharing information and making the case", description: "60-80% talking, presenting organizational information", score: 1 },
                    { value: 'balanced', text: "It's fairly balanced - we both share equally", description: "50/50 split between talking and listening", score: 3 },
                    { value: 'mostly_listening', text: "I do more listening - asking questions and learning about them", description: "60-80% listening, focusing on their perspectives", score: 5 },
                    { value: 'varies', text: "It varies greatly depending on the donor and situation", description: "No consistent pattern in conversation balance", score: 2 }
                ]
            },
            {
                id: 7,
                question: "When do you typically bring up specific funding needs or donation amounts?",
                description: "The timing of your financial asks in the relationship.",
                options: [
                    { value: 'early_meeting', text: "Early in the first or second meeting", description: "Get the financial conversation started quickly", score: 2 },
                    { value: 'after_connection', text: "After establishing a connection to their interests", description: "Wait until you understand what motivates them", score: 5 },
                    { value: 'when_asked', text: "When they ask about ways to get involved", description: "Let them initiate the conversation about giving", score: 4 },
                    { value: 'formal_proposal', text: "In a formal proposal after several meetings", description: "Follow a structured cultivation timeline", score: 3 }
                ]
            },
            {
                id: 8,
                question: "What's your primary goal for a first meeting with a potential major donor?",
                description: "What you most hope to accomplish in that initial conversation.",
                options: [
                    { value: 'secure_gift', text: "Secure a significant gift or commitment", description: "Make the ask and close the deal", score: 1 },
                    { value: 'understand_interests', text: "Understand their interests and motivations", description: "Learn what they care about and why", score: 5 },
                    { value: 'present_opportunities', text: "Present various giving opportunities", description: "Show them different ways to get involved", score: 2 },
                    { value: 'build_rapport', text: "Build rapport and schedule a follow-up meeting", description: "Establish relationship foundation for future conversations", score: 4 }
                ]
            }
        ];

        // App State
        let currentQuestion = 0;
        let answers = {};
        let selectedAnswer = '';
        let isAdmin = false;
        let shareContext = 'home';
        let currentUserScore = 0;
        let currentUserCategory = '';

        // Initialize data with error handling
        let completions = [];
        let shareEvents = [];

        try {
            const storedCompletions = localStorage.getItem('fundraising_completions');
            const storedShares = localStorage.getItem('fundraising_shares');
            
            if (storedCompletions) {
                completions = JSON.parse(storedCompletions);
            }
            if (storedShares) {
                shareEvents = JSON.parse(storedShares);
            }
        } catch (error) {
            console.log('📝 Initializing fresh data storage');
            completions = [];
            shareEvents = [];
        }

        // Navigation Functions
        function showPage(pageId) {
            try {
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.classList.add('active');
                    console.log(`📄 Navigated to: ${pageId}`);
                }
            } catch (error) {
                console.error('❌ Navigation error:', error);
            }
        }

        function startAssessment() {
            try {
                currentQuestion = 0;
                answers = {};
                selectedAnswer = '';
                showPage('assessment-page');
                displayQuestion();
                console.log('🎯 Assessment started');
            } catch (error) {
                console.error('❌ Assessment start error:', error);
            }
        }

        function displayQuestion() {
            try {
                const question = questions[currentQuestion];
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                
                document.getElementById('question-counter').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
                document.getElementById('progress-fill').style.width = `${progress}%`;
                
                const questionCard = document.getElementById('question-card');
                questionCard.innerHTML = `
                    <h2>${question.question}</h2>
                    ${question.description ? `<p style="color: #64748b; margin-bottom: 1.5rem;">${question.description}</p>` : ''}
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectAnswer('${option.value}')">
                                <input type="radio" name="answer" value="${option.value}" ${selectedAnswer === option.value ? 'checked' : ''}>
                                <span>
                                    <div style="font-weight: 500; margin-bottom: 0.25rem;">${option.text}</div>
                                    ${option.description ? `<div style="font-size: 0.875rem; color: #64748b;">${option.description}</div>` : ''}
                                </span>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                updateNavigationButtons();
            } catch (error) {
                console.error('❌ Display question error:', error);
            }
        }

        function selectAnswer(value) {
            try {
                selectedAnswer = value;
                document.querySelectorAll('.option').forEach(option => option.classList.remove('selected'));
                event.currentTarget.classList.add('selected');
                updateNavigationButtons();
                console.log(`✅ Answer selected: ${value}`);
            } catch (error) {
                console.error('❌ Select answer error:', error);
            }
        }

        function updateNavigationButtons() {
            try {
                document.getElementById('prev-btn').disabled = currentQuestion === 0;
                document.getElementById('next-btn').disabled = !selectedAnswer;
                document.getElementById('next-btn').textContent = currentQuestion === questions.length - 1 ? 'Complete Assessment ✅' : 'Next →';
            } catch (error) {
                console.error('❌ Navigation buttons error:', error);
            }
        }

        function nextQuestion() {
            try {
                if (!selectedAnswer) return;
                
                answers[currentQuestion] = selectedAnswer;
                
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    selectedAnswer = answers[currentQuestion] || '';
                    displayQuestion();
                } else {
                    completeAssessment();
                }
            } catch (error) {
                console.error('❌ Next question error:', error);
            }
        }

        function previousQuestion() {
            try {
                if (currentQuestion > 0) {
                    currentQuestion--;
                    selectedAnswer = answers[currentQuestion] || '';
                    displayQuestion();
                }
            } catch (error) {
                console.error('❌ Previous question error:', error);
            }
        }

        function completeAssessment() {
            try {
                const score = calculateScore();
                const category = getScoreCategory(score);
                
                // Store current user's results for sharing
                currentUserScore = score;
                currentUserCategory = category.title;
                
                // Track completion
                const completion = {
                    id: Date.now(),
                    score: score,
                    timestamp: new Date().toISOString(),
                    category: category.title,
                    answers: {...answers},
                    completedQuestions: Object.keys(answers).length
                };
                
                // Get existing completions
                let completions = [];
                try {
                    const stored = localStorage.getItem('fundraising_completions');
                    if (stored) {
                        completions = JSON.parse(stored);
                    }
                } catch (error) {
                    completions = [];
                }
                
                // Add sample data if first completion
                if (completions.length === 0) {
                    const sampleCompletions = [
                        {
                            id: Date.now() - 86400000,
                            score: 85,
                            timestamp: new Date(Date.now() - 86400000).toISOString(),
                            category: 'Donor-Centered Champion',
                            answers: {},
                            completedQuestions: 8
                        },
                        {
                            id: Date.now() - 172800000,
                            score: 72,
                            timestamp: new Date(Date.now() - 172800000).toISOString(),
                            category: 'Relationship Builder',
                            answers: {},
                            completedQuestions: 8
                        },
                        {
                            id: Date.now() - 259200000,
                            score: 45,
                            timestamp: new Date(Date.now() - 259200000).toISOString(),
                            category: 'Transitioning Fundraiser',
                            answers: {},
                            completedQuestions: 8
                        },
                        {
                            id: Date.now() - 345600000,
                            score: 91,
                            timestamp: new Date(Date.now() - 345600000).toISOString(),
                            category: 'Donor-Centered Champion',
                            answers: {},
                            completedQuestions: 8
                        },
                        {
                            id: Date.now() - 432000000,
                            score: 38,
                            timestamp: new Date(Date.now() - 432000000).toISOString(),
                            category: 'Organization-Centered Approach',
                            answers: {},
                            completedQuestions: 8
                        }
                    ];
                    
                    completions = [...sampleCompletions];
                }
                
                // Add new completion
                completions.unshift(completion);
                
                // Keep only last 50 completions
                if (completions.length > 50) {
                    completions = completions.slice(0, 50);
                }
                
                // Save
                try {
                    localStorage.setItem('fundraising_completions', JSON.stringify(completions));
                    console.log('✅ Assessment completion saved');
                } catch (error) {
                    console.error('❌ Error saving completion:', error);
                }
                
                // Display results
                document.getElementById('final-score').textContent = `${score}%`;
                document.getElementById('score-category').textContent = category.title;
                document.getElementById('score-category').className = category.color;
                document.getElementById('score-description').textContent = category.description;
                
                showPage('results-page');
                console.log(`🎉 Assessment completed: ${score}% - ${category.title}`);
            } catch (error) {
                console.error('❌ Complete assessment error:', error);
            }
        }

        function calculateScore() {
            try {
                let totalScore = 0;
                let answeredQuestions = 0;

                Object.entries(answers).forEach(([questionIndex, answerValue]) => {
                    const question = questions[parseInt(questionIndex)];
                    const selectedOption = question.options.find(option => option.value === answerValue);
                    if (selectedOption) {
                        totalScore += selectedOption.score;
                        answeredQuestions++;
                    }
                });

                return answeredQuestions > 0 ? Math.round((totalScore / (answeredQuestions * 5)) * 100) : 0;
            } catch (error) {
                console.error('❌ Calculate score error:', error);
                return 0;
            }
        }

        function getScoreCategory(score) {
            try {
                if (score >= 80) {
                    return {
                        title: 'Donor-Centered Champion',
                        color: 'text-green-600',
                        description: 'You have mastered the art of donor-centered fundraising. You consistently start with curiosity about your donors and build genuine relationships.'
                    };
                } else if (score >= 60) {
                    return {
                        title: 'Relationship Builder',
                        color: 'text-blue-600',
                        description: 'You understand the importance of donor relationships and often put their interests first. With some refinement, you can become even more effective.'
                    };
                } else if (score >= 40) {
                    return {
                        title: 'Transitioning Fundraiser',
                        color: 'text-yellow-600',
                        description: 'You are beginning to shift from organization-centered to donor-centered approaches. Focus on asking more questions and listening more deeply.'
                    };
                } else {
                    return {
                        title: 'Organization-Centered Approach',
                        color: 'text-red-600',
                        description: 'You tend to lead with your organization\'s needs rather than donor interests. Learning to start with curiosity will transform your fundraising success.'
                    };
                }
            } catch (error) {
                console.error('❌ Get score category error:', error);
                return {
                    title: 'Assessment Complete',
                    color: 'text-blue-600',
                    description: 'Thank you for completing the assessment.'
                };
            }
        }

        // ADMIN FUNCTIONS WITH ERROR HANDLING
        function adminLogin() {
            try {
                const password = prompt('🔐 Enter admin password:');
                if (password === 'admin123') {
                    isAdmin = true;
                    updateAnalytics();
                    showPage('analytics-page');
                    console.log('🔓 Admin access granted');
                } else if (password !== null) {
                    alert('❌ Incorrect password');
                }
            } catch (error) {
                console.error('❌ Admin login error:', error);
            }
        }

        function logoutAdmin() {
            try {
                isAdmin = false;
                showPage('home-page');
                console.log('🔒 Admin logged out');
            } catch (error) {
                console.error('❌ Admin logout error:', error);
            }
        }

        function refreshAnalytics() {
            try {
                console.log('🔄 Refreshing analytics...');
                
                const refreshBtn = event.target;
                const originalText = refreshBtn.innerHTML;
                
                refreshBtn.innerHTML = '🔄 Refreshing...';
                refreshBtn.disabled = true;
                
                updateAnalytics();
                
                setTimeout(() => {
                    refreshBtn.innerHTML = '✅ Refreshed!';
                    setTimeout(() => {
                        refreshBtn.innerHTML = originalText;
                        refreshBtn.disabled = false;
                    }, 1000);
                }, 500);
            } catch (error) {
                console.error('❌ Refresh analytics error:', error);
            }
        }

        // ENHANCED ANALYTICS WITH SHARE TRACKING
        function updateAnalytics() {
            try {
                let completions = [];
                let shareEvents = [];
                
                try {
                    const storedCompletions = localStorage.getItem('fundraising_completions');
                    const storedShares = localStorage.getItem('fundraising_shares');
                    
                    if (storedCompletions) {
                        completions = JSON.parse(storedCompletions);
                    }
                    if (storedShares) {
                        shareEvents = JSON.parse(storedShares);
                    }
                } catch (error) {
                    console.log('📊 Using empty analytics data');
                    completions = [];
                    shareEvents = [];
                }

                const totalCompletions = completions.length;
                const totalShares = shareEvents.length;
                const averageScore = totalCompletions > 0 
                    ? Math.round(completions.reduce((sum, c) => sum + c.score, 0) / totalCompletions)
                    : 0;
                
                const thisMonth = completions.filter(c => {
                    try {
                        const completionDate = new Date(c.timestamp);
                        const now = new Date();
                        return completionDate.getMonth() === now.getMonth() && 
                               completionDate.getFullYear() === now.getFullYear();
                    } catch {
                        return false;
                    }
                }).length;

                // Calculate category breakdown
                const categoryCount = {};
                completions.forEach(c => {
                    if (c.category) {
                        categoryCount[c.category] = (categoryCount[c.category] || 0) + 1;
                    }
                });

                // Calculate share breakdown
                const shareCount = {};
                shareEvents.forEach(s => {
                    if (s.platform) {
                        shareCount[s.platform] = (shareCount[s.platform] || 0) + 1;
                    }
                });

                // Update basic stats
                document.getElementById('total-completions').textContent = totalCompletions;
                document.getElementById('average-score').textContent = `${averageScore}%`;
                document.getElementById('month-completions').textContent = thisMonth;
                document.getElementById('total-shares').textContent = totalShares;

                // Update category breakdown
                const categoryBreakdownList = document.getElementById('category-breakdown-list');
                if (totalCompletions === 0) {
                    categoryBreakdownList.innerHTML = `
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No data yet. Complete assessments to see category distribution.
                        </p>
                    `;
                } else {
                    const sortedCategories = Object.entries(categoryCount)
                        .sort(([,a], [,b]) => b - a)
                        .map(([category, count]) => ({
                            category,
                            count,
                            percentage: Math.round((count / totalCompletions) * 100)
                        }));

                    categoryBreakdownList.innerHTML = sortedCategories.map(item => `
                        <div class="category-item">
                            <div class="category-name">${item.category}</div>
                            <div class="category-stats">
                                <div class="category-percentage">${item.percentage}%</div>
                                <div class="category-count">(${item.count} users)</div>
                                <div class="category-bar">
                                    <div class="category-bar-fill" style="width: ${item.percentage}%"></div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }

                // Update share statistics
                const shareStatsList = document.getElementById('share-stats-list');
                if (totalShares === 0) {
                    shareStatsList.innerHTML = `
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No shares yet. Share events will be tracked here.
                        </p>
                    `;
                } else {
                    const sortedShares = Object.entries(shareCount)
                        .sort(([,a], [,b]) => b - a);

                    shareStatsList.innerHTML = sortedShares.map(([platform, count]) => `
                        <div class="share-item">
                            <div style="font-weight: 500; color: #1e293b;">${platform}</div>
                            <div style="color: #3b82f6; font-weight: 600;">${count} shares</div>
                        </div>
                    `).join('');
                }

                // Update recent completions
                const completionsList = document.getElementById('completions-list');
                if (totalCompletions === 0) {
                    completionsList.innerHTML = `
                        <p style="text-align: center; color: #64748b; padding: 2rem;">
                            No completions yet. Take the assessment to see data!
                        </p>
                    `;
                } else {
                    completionsList.innerHTML = completions.slice(0, 15).map(completion => `
                        <div class="completion-item">
                            <div class="completion-score">${completion.score}%</div>
                            <div style="flex: 1;">
                                <div class="completion-category">${completion.category}</div>
                                <div class="completion-date">
                                    ${new Date(completion.timestamp).toLocaleDateString()} 
                                    ${new Date(completion.timestamp).toLocaleTimeString()}
                                </div>
                            </div>
                        </div>
                    `).join('');
                }

                console.log('📊 Analytics updated:', {
                    total: totalCompletions,
                    average: averageScore,
                    thisMonth: thisMonth,
                    totalShares: totalShares,
                    categories: categoryCount,
                    shares: shareCount
                });
            } catch (error) {
                console.error('❌ Update analytics error:', error);
            }
        }

        // ENHANCED SHARE FUNCTIONS WITH ERROR HANDLING
        function openShareModal(context = 'home') {
            try {
                shareContext = context;
                const modal = document.getElementById('share-modal');
                const title = document.getElementById('share-modal-title');
                const urlDisplay = document.getElementById('share-url-display');
                const previewContent = document.getElementById('share-preview-content');
                
                // Update modal title and preview based on context
                switch(context) {
                    case 'results':
                        title.textContent = '📤 Share Your Results';
                        previewContent.innerHTML = getResultsSharePreview();
                        break;
                    case 'resources':
                        title.textContent = '📤 Share Resources';
                        previewContent.innerHTML = getResourcesSharePreview();
                        break;
                    default:
                        title.textContent = '📤 Share Assessment';
                        previewContent.innerHTML = getHomeSharePreview();
                }
                
                urlDisplay.textContent = window.location.href;
                modal.classList.remove('hidden');
                console.log(`📤 Share modal opened: ${context}`);
            } catch (error) {
                console.error('❌ Open share modal error:', error);
            }
        }

        function closeShareModal() {
            try {
                document.getElementById('share-modal').classList.add('hidden');
                console.log('📤 Share modal closed');
            } catch (error) {
                console.error('❌ Close share modal error:', error);
            }
        }

        function getHomeSharePreview() {
            try {
                return `🎯 Transform your fundraising approach with this donor-centered assessment by Mark Dobosz.

Stop leading with your organization's needs and start with curiosity about your donors.

Take the assessment: ${window.location.href}

#Fundraising #NonProfit #DonorRelations`;
            } catch (error) {
                console.error('❌ Get home share preview error:', error);
                return 'Transform your fundraising approach with this assessment.';
            }
        }

        function getResultsSharePreview() {
            try {
                const emoji = currentUserScore >= 80 ? '🎉' : currentUserScore >= 60 ? '👍' : '📈';
                return `${emoji} I scored ${currentUserScore}% as a "${currentUserCategory}" in this fundraising assessment!

The assessment evaluates whether you're using donor-centered or organization-centered approaches.

Take the assessment yourself: ${window.location.href}

#Fundraising #Assessment #DonorCentered`;
            } catch (error) {
                console.error('❌ Get results share preview error:', error);
                return 'Check out my fundraising assessment results!';
            }
        }

        function getResourcesSharePreview() {
            try {
                return `📚 Excellent fundraising resources focusing on donor-centered approaches:

✓ Conversation starters that work
✓ Active listening techniques  
✓ Building authentic relationships
✓ Timing your ask perfectly

Check out these best practices: ${window.location.href}

#Fundraising #Resources #BestPractices`;
            } catch (error) {
                console.error('❌ Get resources share preview error:', error);
                return 'Great fundraising resources and best practices.';
            }
        }

        function trackShare(platform, context) {
            try {
                const shareEvent = {
                    id: Date.now(),
                    platform: platform,
                    context: context,
                    timestamp: new Date().toISOString(),
                    url: window.location.href
                };

                let shareEvents = [];
                try {
                    const stored = localStorage.getItem('fundraising_shares');
                    if (stored) {
                        shareEvents = JSON.parse(stored);
                    }
                } catch (error) {
                    shareEvents = [];
                }

                shareEvents.unshift(shareEvent);
                
                // Keep only last 100 share events
                if (shareEvents.length > 100) {
                    shareEvents = shareEvents.slice(0, 100);
                }

                try {
                    localStorage.setItem('fundraising_shares', JSON.stringify(shareEvents));
                    console.log(`📤 Share tracked: ${platform} - ${context}`);
                } catch (error) {
                    console.error('❌ Error saving share event:', error);
                }
            } catch (error) {
                console.error('❌ Track share error:', error);
            }
        }

        function shareViaEmail() {
            try {
                const url = window.location.href;
                let subject, body;
                
                switch(shareContext) {
                    case 'results':
                        subject = encodeURIComponent(`My Fundraising Assessment Results - ${currentUserScore}% Score!`);
                        body = encodeURIComponent(`Hi there!

I just completed this fundraising assessment and wanted to share my results with you.

🎯 My Score: ${currentUserScore}% - "${currentUserCategory}"

The assessment evaluates whether you're using a donor-centered or organization-centered approach to fundraising. It's really insightful!

Key insights from my results:
• ${currentUserScore >= 80 ? 'I\'m already using donor-centered approaches effectively!' : 'I have opportunities to improve my donor-centered approach'}
• The assessment provides specific recommendations for improvement
• It focuses on starting with curiosity about donors rather than organizational needs

Take the assessment yourself: ${url}

I'd love to hear about your results!

Best regards`);
                        break;
                    case 'resources':
                        subject = encodeURIComponent('Fundraising Best Practices - Donor-Centered Resources');
                        body = encodeURIComponent(`Hi there!

I found these excellent fundraising resources that focus on donor-centered approaches and wanted to share them with you.

The guide covers:
📝 Conversation starters that actually work
👂 Active listening techniques for deeper engagement  
🤝 Building authentic relationships with donors
⏰ Perfect timing for making your ask
🚫 Common mistakes to avoid

These resources emphasize starting with curiosity about donors rather than leading with organizational needs - a game-changing approach!

Check it out: ${url}

Hope you find it as valuable as I did!

Best regards`);
                        break;
                    default:
                        subject = encodeURIComponent('Fundraising Assessment - Transform Your Donor Relationships');
                        body = encodeURIComponent(`Hi there!

I thought you'd be interested in this fundraising assessment that helps transform donor relationships.

🎯 What it does:
• Evaluates your fundraising approach (donor-centered vs organization-centered)
• Provides personalized recommendations for improvement
• Includes comprehensive best practices guide
• Takes just 5 minutes to complete

💡 Key insight: Stop leading with your organization's needs and start with curiosity about your donors.

The assessment was created by Mark Dobosz and focuses on building authentic relationships that benefit both your cause and your supporters.

Take the assessment: ${url}

I'd love to hear what you think!

Best regards`);
                }
                
                window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
                trackShare('Email', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via email error:', error);
            }
        }

        function shareViaLinkedIn() {
            try {
                const url = encodeURIComponent(window.location.href);
                let text;
                
                switch(shareContext) {
                    case 'results':
                        text = encodeURIComponent(`🎯 Just completed this fundraising assessment and scored ${currentUserScore}% as a "${currentUserCategory}"!

The assessment evaluates whether you're using donor-centered or organization-centered approaches. Key insight: Start with curiosity about donors, not organizational needs.

Great tool for fundraising professionals looking to improve their approach.`);
                        break;
                    case 'resources':
                        text = encodeURIComponent(`📚 Excellent fundraising resources focusing on donor-centered approaches:

✓ Conversation starters that work
✓ Active listening techniques  
✓ Building authentic relationships
✓ Perfect timing for asks

Essential reading for fundraising professionals.`);
                        break;
                    default:
                        text = encodeURIComponent(`🎯 Transform your fundraising approach: Stop leading with your organization's needs and start with curiosity about your donors.

This assessment evaluates your current approach and provides personalized recommendations. Created by Mark Dobosz.

Essential tool for fundraising professionals.`);
                }
                
                window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}&summary=${text}`, '_blank');
                trackShare('LinkedIn', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via LinkedIn error:', error);
            }
        }

        function shareViaTwitter() {
            try {
                const url = encodeURIComponent(window.location.href);
                let text;
                
                switch(shareContext) {
                    case 'results':
                        text = encodeURIComponent(`🎯 Scored ${currentUserScore}% as "${currentUserCategory}" in this fundraising assessment!

Key insight: Start with curiosity about donors, not org needs.

#Fundraising #NonProfit #DonorCentered`);
                        break;
                    case 'resources':
                        text = encodeURIComponent(`📚 Essential fundraising resources:
✓ Donor-centered conversation starters
✓ Active listening techniques
✓ Authentic relationship building

#Fundraising #Resources #NonProfit`);
                        break;
                    default:
                        text = encodeURIComponent(`🎯 Stop leading with your org's needs. Start with curiosity about your donors.

Transform your fundraising approach with this assessment.

#Fundraising #DonorCentered #NonProfit`);
                }
                
                window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
                trackShare('Twitter', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via Twitter error:', error);
            }
        }

        function shareViaFacebook() {
            try {
                const url = encodeURIComponent(window.location.href);
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
                trackShare('Facebook', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via Facebook error:', error);
            }
        }

        function shareViaWhatsApp() {
            try {
                const url = window.location.href;
                let text;
                
                switch(shareContext) {
                    case 'results':
                        text = `🎯 Just took this fundraising assessment and scored ${currentUserScore}% as "${currentUserCategory}"!

The key insight: Start with curiosity about donors, not organizational needs.

Check it out: ${url}`;
                        break;
                    case 'resources':
                        text = `📚 Found these great fundraising resources focusing on donor-centered approaches:

✓ Conversation starters
✓ Active listening techniques  
✓ Building authentic relationships

${url}`;
                        break;
                    default:
                        text = `🎯 Transform your fundraising approach!

Stop leading with your organization's needs and start with curiosity about your donors.

Take this assessment: ${url}`;
                }
                
                const encodedText = encodeURIComponent(text);
                window.open(`https://wa.me/?text=${encodedText}`, '_blank');
                trackShare('WhatsApp', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via WhatsApp error:', error);
            }
        }

        function shareViaSMS() {
            try {
                const url = window.location.href;
                let text;
                
                switch(shareContext) {
                    case 'results':
                        text = `I scored ${currentUserScore}% as "${currentUserCategory}" in this fundraising assessment! Check it out: ${url}`;
                        break;
                    case 'resources':
                        text = `Great fundraising resources on donor-centered approaches: ${url}`;
                        break;
                    default:
                        text = `Transform your fundraising approach with this assessment: ${url}`;
                }
                
                const encodedText = encodeURIComponent(text);
                window.open(`sms:?body=${encodedText}`, '_blank');
                trackShare('SMS', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Share via SMS error:', error);
            }
        }

        function copyShareLink() {
            try {
                const url = window.location.href;
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(url).then(() => {
                        alert('✅ Link copied to clipboard!');
                        console.log('📋 URL copied to clipboard');
                    }).catch(() => {
                        promptShare(url);
                    });
                } else {
                    promptShare(url);
                }
                trackShare('Copy Link', shareContext);
                closeShareModal();
            } catch (error) {
                console.error('❌ Copy share link error:', error);
                promptShare(window.location.href);
            }
        }

        function shareNative() {
            try {
                const url = window.location.href;
                let title, text;
                
                switch(shareContext) {
                    case 'results':
                        title = 'My Fundraising Assessment Results';
                        text = `I scored ${currentUserScore}% as "${currentUserCategory}" in this fundraising assessment!`;
                        break;
                    case 'resources':
                        title = 'Fundraising Resources';
                        text = 'Excellent fundraising resources focusing on donor-centered approaches';
                        break;
                    default:
                        title = 'Fundraising Assessment Pro';
                        text = 'Transform your fundraising approach with donor-centered strategies';
                }
                
                if (navigator.share) {
                    navigator.share({
                        title: title,
                        text: text,
                        url: url
                    }).then(() => {
                        console.log('✅ Native share successful');
                        trackShare('Native Share', shareContext);
                    }).catch((error) => {
                        console.log('Share cancelled or failed:', error);
                    });
                } else {
                    // Fallback to copy
                    copyShareLink();
                }
                closeShareModal();
            } catch (error) {
                console.error('❌ Native share error:', error);
                copyShareLink();
            }
        }

        function promptShare(url) {
            try {
                const result = prompt('Copy this URL to share:', url);
                if (result !== null) {
                    console.log('📋 URL provided for manual copying');
                }
            } catch (error) {
                console.error('❌ Prompt share error:', error);
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            try {
                const modal = document.getElementById('share-modal');
                if (event.target === modal) {
                    closeShareModal();
                }
            } catch (error) {
                console.error('❌ Modal click handler error:', error);
            }
        });

        // Initialize app with error handling
        document.addEventListener('DOMContentLoaded', function() {
            try {
                showPage('home-page');
                console.log('🚀 Fundraising Assessment Pro loaded successfully');
                console.log('👤 Admin password: admin123');
                console.log('📊 Enhanced analytics with share tracking: Active');
                console.log('📧 Professional email sharing: Active');
                console.log('📱 Mobile sharing (WhatsApp, SMS): Active');
                console.log('📚 Resources page: Available');
                console.log('❓ Questions: 8 complete questions');
                console.log('✅ All functions loaded and ready');
            } catch (error) {
                console.error('❌ App initialization error:', error);
            }
        });
    </script>
</body>
</html>
    
  </body>
  
</html>
